<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPARQL Endpoint Tool - Help</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.2em;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .nav {
            background-color: #34495e;
            padding: 0;
        }
        .nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
        }
        .nav li {
            margin: 0;
        }
        .nav a {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        .nav a:hover {
            background-color: #2c3e50;
        }
        .content {
            padding: 30px;
        }
        .section {
            margin-bottom: 40px;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h3 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .config-example {
            background-color: #f0f8ff;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        .info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 20px;
            border-left: 4px solid #28a745;
        }
        .feature-card h4 {
            margin-top: 0;
            color: #28a745;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.2s;
        }
        .back-link:hover {
            background-color: #2980b9;
        }
        .toc {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .toc ul {
            margin: 10px 0;
        }
        .toc a {
            color: #2c3e50;
            text-decoration: none;
        }
        .toc a:hover {
            color: #3498db;
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .content {
                padding: 20px;
            }
            .nav ul {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç SPARQL Endpoint Tool</h1>
            <p>Ad-hoc SPARQL endpoint with YASGUI interface and AI assistance</p>
        </div>

        <nav class="nav">
            <ul>
                <li><a href="/">‚Üê Back to Tool</a></li>
                <li><a href="#getting-started">Getting Started</a></li>
                <li><a href="#ai-features">AI Features</a></li>
                <li><a href="#configuration">Configuration</a></li>
                <li><a href="#usage">Usage Examples</a></li>
            </ul>
        </nav>

        <div class="content">
            <div class="toc">
                <h3>Table of Contents</h3>
                <ul>
                    <li><a href="#getting-started">Getting Started</a></li>
                    <li><a href="#ai-features">AI Features & Configuration</a></li>
                    <li><a href="#configuration">Configuration Options</a></li>
                    <li><a href="#usage">Usage Examples</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#api">API Endpoints</a></li>
                </ul>
            </div>

            <div class="section" id="getting-started">
                <h2>Getting Started</h2>
                
                <h3>Installation</h3>
                <div class="code-block"># Install globally with uv
uv tool install --editable .

# Or with pipx
pipx install --editable .</div>

                <h3>Basic Usage</h3>
                <div class="code-block"># Start with RDF files
sparql-endpoint file1.ttl file2.rdf

# Specify format explicitly
sparql-endpoint --format turtle data.ttl

# Custom host and port
sparql-endpoint --host 0.0.0.0 --port 9000 data.ttl</div>

                <div class="info">
                    <strong>Supported RDF Formats:</strong> Turtle (.ttl), RDF/XML (.rdf, .xml), N-Triples (.nt), N3 (.n3), JSON-LD (.jsonld, .json)
                </div>
            </div>

            <div class="section" id="ai-features">
                <h2>AI Features & Configuration</h2>
                
                <p>The tool includes an AI-powered chat assistant that can help with SPARQL queries. It supports both OpenAI GPT and Anthropic Claude models.</p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>ü§ñ Query Interpretation</h4>
                        <p>Explains your SPARQL queries in natural language. Click "Explain Query" or ask "explain my query".</p>
                    </div>
                    <div class="feature-card">
                        <h4>‚ú® Query Generation</h4>
                        <p>Generate SPARQL queries from natural language descriptions like "Show me all products with price > 100".</p>
                    </div>
                    <div class="feature-card">
                        <h4>üîÑ Interactive Refinement</h4>
                        <p>Modify existing queries through conversation: "Add a limit of 20", "Filter by date range".</p>
                    </div>
                    <div class="feature-card">
                        <h4>üéØ Context Awareness</h4>
                        <p>The AI knows your graph structure, available prefixes, and current query for intelligent assistance.</p>
                    </div>
                </div>

                <h3>AI Configuration Hierarchy</h3>
                <p>The system uses the following priority order (highest to lowest):</p>
                
                <div class="config-example">
                    <strong>1. Environment Variables (Recommended)</strong>
                    <div class="code-block"># For Anthropic Claude
export ANTHROPIC_API_KEY="sk-ant-your-key-here"

# For OpenAI GPT
export OPENAI_API_KEY="sk-your-key-here"

# Optional: Disable AI features
export SPARQL_AI_ENABLED=false</div>
                </div>

                <div class="config-example">
                    <strong>2. Configuration File</strong>
                    <p>Create one of these files (in order of precedence):</p>
                    <ul>
                        <li><code>./sparql-config.toml</code> (current directory)</li>
                        <li><code>~/.config/sparql-endpoint-tool/config.toml</code></li>
                        <li><code>~/.sparql-endpoint-tool.toml</code></li>
                    </ul>
                </div>

                <div class="config-example">
                    <strong>3. Default Values</strong>
                    <ul>
                        <li>AI features: <strong>enabled by default</strong></li>
                        <li>Default provider: <strong>Anthropic Claude</strong></li>
                        <li>Models: GPT-4, Claude-3.5-Sonnet</li>
                    </ul>
                </div>

                <div class="warning">
                    <strong>Important:</strong> AI features will be automatically disabled if no API keys are found. The interface will show the current status in the chat panel.
                </div>
            </div>

            <div class="section" id="configuration">
                <h2>Configuration Options</h2>

                <h3>Complete Configuration Example</h3>
                <div class="code-block"># sparql-config.toml

[ai]
enabled = true
default_provider = "anthropic"  # or "openai"

# API Keys (better to use environment variables)
anthropic_api_key = "sk-ant-your-key"
openai_api_key = "sk-your-key"

# Model Settings
openai_model = "gpt-4"
anthropic_model = "claude-3-5-sonnet-20241022"

# Generation Parameters
max_tokens = 2000
temperature = 0.1

[server]
host = "127.0.0.1"
port = 8000</div>

                <h3>Configuration Options Explained</h3>
                
                <h4>AI Section</h4>
                <ul>
                    <li><strong>enabled</strong>: Enable/disable AI features (default: true)</li>
                    <li><strong>default_provider</strong>: "anthropic" or "openai" (default: "anthropic")</li>
                    <li><strong>max_tokens</strong>: Maximum response length (default: 2000)</li>
                    <li><strong>temperature</strong>: AI creativity level 0.0-1.0 (default: 0.1)</li>
                </ul>

                <h4>Server Section</h4>
                <ul>
                    <li><strong>host</strong>: Server bind address (default: "127.0.0.1")</li>
                    <li><strong>port</strong>: Server port (default: 8000)</li>
                </ul>

                <h3>Environment Variables</h3>
                <div class="code-block"># AI Configuration
ANTHROPIC_API_KEY=sk-ant-your-key
OPENAI_API_KEY=sk-your-key
SPARQL_AI_ENABLED=true
SPARQL_AI_DEFAULT_PROVIDER=anthropic

# Server Configuration  
SPARQL_HOST=127.0.0.1
SPARQL_PORT=8000</div>
            </div>

            <div class="section" id="usage">
                <h2>Usage Examples</h2>

                <h3>Starting the Server</h3>
                <div class="code-block"># Basic usage
sparql-endpoint data.ttl

# Multiple files
sparql-endpoint ontology.ttl instances.ttl

# Custom server settings
sparql-endpoint --host 0.0.0.0 --port 9000 --format turtle data.ttl

# Enable development auto-reload
sparql-endpoint --reload data.ttl</div>

                <h3>AI Chat Examples</h3>
                
                <h4>Query Generation</h4>
                <ul>
                    <li>"Show me all products"</li>
                    <li>"Find entities with type Person"</li>
                    <li>"Get all triples where the subject is a specific URI"</li>
                    <li>"List all classes in this dataset"</li>
                </ul>

                <h4>Query Refinement</h4>
                <ul>
                    <li>"Add a LIMIT 10 to this query"</li>
                    <li>"Filter results where price is greater than 100"</li>
                    <li>"Order by name ascending"</li>
                    <li>"Group the results by category"</li>
                </ul>

                <h4>Learning & Help</h4>
                <ul>
                    <li>"Explain this SPARQL query"</li>
                    <li>"What does OPTIONAL mean in SPARQL?"</li>
                    <li>"How do I use FILTER in SPARQL?"</li>
                    <li>"Show me examples of CONSTRUCT queries"</li>
                </ul>
            </div>

            <div class="section" id="troubleshooting">
                <h2>Troubleshooting</h2>

                <h3>AI Features Not Working</h3>
                
                <div class="warning">
                    <strong>Check AI Status:</strong> Visit <code>http://localhost:8000/ai/status</code> to see current configuration
                </div>

                <h4>Common Issues:</h4>
                <ul>
                    <li><strong>"AI features not configured"</strong>: No API keys found. Set environment variables or config file.</li>
                    <li><strong>"0 AI provider(s) available"</strong>: API keys are set but invalid or expired.</li>
                    <li><strong>Chat not responding</strong>: Check browser console for errors. Verify API key permissions.</li>
                </ul>

                <h3>Port Already in Use</h3>
                <div class="code-block"># Find process using port 8000
lsof -i :8000

# Kill process
kill PID_NUMBER

# Or use different port
sparql-endpoint --port 8001 data.ttl</div>

                <h3>RDF Loading Issues</h3>
                <ul>
                    <li><strong>File not found</strong>: Check file paths are correct</li>
                    <li><strong>Parse errors</strong>: Verify RDF syntax, try specifying format explicitly</li>
                    <li><strong>Large files</strong>: Loading may take time, check server logs</li>
                </ul>
            </div>

            <div class="section" id="api">
                <h2>API Endpoints</h2>

                <h3>Core Endpoints</h3>
                <ul>
                    <li><strong>GET /</strong>: Main YASGUI interface</li>
                    <li><strong>POST /sparql</strong>: SPARQL endpoint</li>
                    <li><strong>GET /info</strong>: Graph information (triple count, namespaces)</li>
                    <li><strong>GET /prefixes</strong>: Available SPARQL prefixes</li>
                    <li><strong>GET /health</strong>: Health check</li>
                    <li><strong>GET /help</strong>: This help page</li>
                </ul>

                <h3>AI Endpoints</h3>
                <ul>
                    <li><strong>GET /ai/status</strong>: AI configuration status</li>
                    <li><strong>POST /ai/chat</strong>: General AI conversation</li>
                    <li><strong>POST /ai/interpret</strong>: Query interpretation</li>
                    <li><strong>POST /ai/generate</strong>: Query generation</li>
                </ul>

                <h3>Example API Usage</h3>
                <div class="code-block"># Check AI status
curl http://localhost:8000/ai/status

# Execute SPARQL query
curl -X POST http://localhost:8000/sparql \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "query=SELECT * WHERE { ?s ?p ?o } LIMIT 10"

# AI query interpretation
curl -X POST http://localhost:8000/ai/interpret \
  -H "Content-Type: application/json" \
  -d '{"query": "SELECT ?s WHERE { ?s a ?type }", "provider": "anthropic"}'</div>
            </div>

            <div class="info" style="margin-top: 40px;">
                <strong>Need more help?</strong> Check the project repository or create an issue for additional support.
            </div>
        </div>
    </div>
</body>
</html>